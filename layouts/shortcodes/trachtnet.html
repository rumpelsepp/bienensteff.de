{{ $region := .Get "region" | default "Bayern" }}
{{ $cssID := printf "%sChart" $region }}

<script type="module">
  import { LineChart, getTrachtnetSeries } from "/bundle.js";
  let thisYear = new Date().getFullYear();
  let years = Array.from({ length: 4 }, (_, i) => thisYear - i).reverse();

  window.addEventListener("load", async () => {
      const dom = document.getElementById("{{ $cssID }}");
      const data = await getTrachtnetSeries(years, "{{ $region }}", true);

      const chart = new LineChart(data, "Trachtverlauf {{ $region }}");
      chart.render("{{ $cssID }}");
  });
</script>

<div class="chart-container mb-4">
    <div class="card">
        <div class="card-body">
            <div id="{{ $cssID }}" style="height: 400px;"></div>
        </div>
    </div>
</div>